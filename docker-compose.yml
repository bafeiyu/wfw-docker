version: "3.6"

services: 
    php74:
        image: php74
        build: ./php74
        container_name: php74
        volumes:
            - "./php74/php.ini:/usr/local/etc/php/php.ini"
            - "./php74/www.conf:/usr/local/etc/php-fpm.d/www.conf" 
            - "/mnt/hgfs/dev_share:/www"
        network_mode: "host"   
        privileged: true
        restart: always
    mysql57:
        image: mysql57
        build: ./mysql57
        container_name: mysql57
        volumes:
            - "./mysql57/mysql.cnf:/etc/mysql/conf.d/mysql.cnf"
            - "./mysql57/data:/var/lib/mysql"
        network_mode: "host"   
        privileged: true   
        restart: always
        environment: 
            MYSQL_ROOT_PASSWORD: "root"
            MYSQL_DATABASE: "test"
            MYSQL_USER: "test"
            MYSQL_PASSWORD: "test" 
    rabbitmq-node1:
        image: rabbitmq-node1
        build: ./rabbitmq
        container_name: rabbitmq-node1
        volumes:
            - "./rabbitmq/rabbitmq.conf:/etc/rabbitmq/rabbitmq.conf"
            - "./rabbitmq/data:/var/lib/rabbitmq" 
        network_mode: "host" 
        hostname: node1  
        privileged: true
        restart: always
    konga:
        image: konga
        build: ./konga
        container_name: konga
        network_mode: "host"
        privileged: true
        restart: always
        environment: 
            TOKEN_SECRET: "yyb-konga"
            DB_ADAPTER: "postgres"   
            DB_HOST: "127.0.0.1"
            DB_PORT: 5432
            DB_USER: "kong" 
            DB_PASSWORD: "123123"
            DB_DATABASE: "kong" 
            NODE_ENV: "production"              
